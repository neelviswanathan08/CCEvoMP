% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualize_results.R
\name{analyze_urw_trait}
\alias{analyze_urw_trait}
\title{Analyze Trait Data for Unbiased Random Walk (URW) Pattern}
\usage{
analyze_urw_trait(
  data = NULL,
  plot_file = "urw_plot.png",
  include_nre = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{data}{A data frame containing the time series data with columns:
\itemize{
\item mn: Mean trait values
\item time: Time points
}}

\item{plot_file}{Character string specifying the filename for saving the plot (default: "urw_plot.png")}

\item{include_nre}{Logical, whether to include non-random event detection in the analysis (default: TRUE)}

\item{verbose}{Logical, whether to print detailed analysis summary (default: TRUE)}
}
\value{
A list containing:
\item{nre_present}{Logical indicating if non-random events were detected}
\item{normality_p}{P-value from the normality test on differences}
\item{normality_pass}{Logical indicating if the differences pass the normality test (p >= 0.05)}
\item{slope_check}{Logical indicating if the average difference between consecutive points is < 0.03}
\item{average_difference}{Average difference between consecutive time points}
\item{urw_prediction}{Logical indicating if the data is consistent with URW}
\item{rules_triggered}{List of control chart rules that were triggered}
\item{calculated_limits}{Vector containing the calculated LCL and UCL}
}
\description{
This function analyzes trait data to determine if it follows an unbiased random walk (URW) pattern,
which is characterized by random changes in trait values over time with no consistent direction.
It uses control charts and statistical tests to detect non-random evolution and test for normality.
}
\details{
The function performs the following analyses:
\enumerate{
\item Calculates first differences between consecutive time points
\item Adjusts for autocorrelation in the differences
\item Sets up control charts using the adjusted standard deviation
\item Tests for normality of the differences using a Chi-squared test
\item Checks for non-random patterns in the differences
\item Determines if the data is consistent with URW based on the test results
}
}
\examples{
\dontrun{
  # Example usage:
  data <- data.frame(
    mn = cumsum(rnorm(20, mean = 0, sd = 0.5)),
    time = 1:20
  )
  result <- analyze_urw_trait(data)
}

}
